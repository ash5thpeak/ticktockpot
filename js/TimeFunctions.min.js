var counter=0;function LimitImputLength(e){var textbox=document.getElementById(e.target.id);e.keyCode>=35&&e.keyCode<=39||((e.shiftKey||e.keyCode<45&&e.keyCode>57||e.keyCode<96&&e.keyCode>101||43===e.keyCode||45===e.keyCode||46===e.keyCode||101===e.keyCode)&&e.preventDefault(),textbox.value.toString().length>=3&&e.preventDefault(),13==e.keyCode&&AddTime(addHours,addMins,lblTimeClock_hours,lblTimeClock_mins,itemisedTimes))}function AddTime(addHours,addMins,tickerHours,tickerMins){var Hours=parseInt(document.getElementById(addHours.id).value),Mins=parseInt(document.getElementById(addMins.id).value),TotalHours=parseInt(document.getElementById(tickerHours.id).innerHTML),TotalMins=parseInt(document.getElementById(tickerMins.id).innerHTML),NotGoingToProcess=!1;if(""!=Hours&&""!=document.getElementById(addHours.id).value||(Hours=0),""!=Mins&&""!=document.getElementById(addMins.id).value||(Mins=0),0==Hours&&0==Mins&&(NotGoingToProcess=!0),(isNaN(Hours)||isNaN(Mins))&&(NotGoingToProcess=!0),!NotGoingToProcess){var hoursFromMinutes,remainderMins;TotalMins+=Mins,TotalHours+=Hours,TotalHours+=Math.floor(TotalMins/60),TotalMins=TotalMins%60,document.getElementById(tickerHours.id).innerHTML=TotalHours,document.getElementById(tickerMins.id).innerHTML=TotalMins;var itemisedTimeRow=document.createElement("div");itemisedTimeRow.setAttribute("ID","Time"+ ++counter),itemisedTimeRow.setAttribute("Hours",Hours),itemisedTimeRow.setAttribute("Mins",Mins),itemisedTimeRow.setAttribute("class","time-inventory");var itemisedTimeItem=document.createElement("div");itemisedTimeItem.setAttribute("class","time-item");var itemisedTimeItemNode=document.createTextNode(" + "+Hours+" hrs  "+Mins+" mins");itemisedTimeItem.appendChild(itemisedTimeItemNode),itemisedTimeRow.appendChild(itemisedTimeItem);var itemisedTimeDelete=document.createElement("div");itemisedTimeDelete.setAttribute("class","time-item-delete");var subtractTimeIcon=document.createElement("div");subtractTimeIcon.setAttribute("class","delete-btn"),subtractTimeIcon.setAttribute("Title","Delete Entry"),subtractTimeIcon.onclick=function(){SubtractTime(itemisedTimeRow.getAttribute("ID"),tickerHours,tickerMins)};var itemisedTimeDeleteNode=document.createTextNode("x");subtractTimeIcon.appendChild(itemisedTimeDeleteNode),itemisedTimeDelete.appendChild(subtractTimeIcon),itemisedTimeRow.appendChild(itemisedTimeDelete),document.getElementById("itemisedTimes").appendChild(itemisedTimeRow),document.getElementById(addHours.id).focus(),document.getElementById(addHours.id).value="",document.getElementById(addMins.id).value="",ShowHideItemToggle()}}function SubtractTime(TimeToBeDeletedID,tickerHours,tickerMins){var Hours=parseInt(document.getElementById(TimeToBeDeletedID).getAttribute("Hours")),Mins=parseInt(document.getElementById(TimeToBeDeletedID).getAttribute("Mins")),TotalHours=parseInt(document.getElementById(tickerHours.id).innerHTML),TotalMins=parseInt(document.getElementById(tickerMins.id).innerHTML),ConvertedTotalTime,hoursFromMinutes,remainderMins;TotalMins=60*TotalHours+TotalMins-(60*Hours+Mins),TotalHours=Math.floor(TotalMins/60),TotalMins=TotalMins%60,console.log(TotalHours+" hrs "+TotalMins+" mins"),document.getElementById(tickerHours.id).innerHTML=TotalHours,document.getElementById(tickerMins.id).innerHTML=TotalMins,document.getElementById(TimeToBeDeletedID).remove(),ShowHideItemToggle()}function numberWithCommas(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function ShowHideItemToggle(){var itemisedTimeDiv,itemCount;document.getElementById("itemisedTimes").getElementsByClassName("time-inventory").length>0?(document.getElementById("btnEntriesToggle").style.display="block",document.getElementById("demo").className="collapse in"):(document.getElementById("btnEntriesToggle").style.display="none",document.getElementById("demo").className="collapse")}function ShowHideCaption(){"collapse in"==document.getElementById("demo").className?document.getElementById("entriesText").innerHTML="View all entries":document.getElementById("entriesText").innerHTML="Hide all entries"}function AddANote(){}function ExportAsCSV(e){console.log(e.target.nodeName);for(var itemisedTimeDiv=document.getElementById("itemisedTimes"),items=document.getElementsByClassName("time-inventory"),itemCount=document.getElementsByClassName("time-inventory").length,timeItems=[],index=0;index<itemCount;index++){var element=items[index],obj={};obj.Hour=element.getAttribute("hours"),obj.Mins=element.getAttribute("mins"),timeItems.push(obj)}var lineArray=[];timeItems.forEach(function(infoArray,index){var line=toCSV(infoArray);lineArray.push(0==index?"data:text/csv;charset=utf-8\n,Hours,Mins,\n"+line:line)});var csvContent=lineArray.join("\n"),encodedUri=encodeURI(csvContent),link=document.createElement("a");link.setAttribute("href",encodedUri),link.setAttribute("download","ItemisedTimes.csv"),document.body.appendChild(link),link.click(),document.body.removeChild(link),e.preventDefault()}function toCSV(obj,separator){var arr=[];for(var key in obj)obj.hasOwnProperty(key)&&arr.push(obj[key]);return arr.join(separator||",")}document.getElementById("entriesText").addEventListener("click",function(){ShowHideCaption()}),window.onload=function(){document.getElementById(addHours.id).focus(),document.getElementById(addHours.id).onkeypress=function(e){LimitImputLength(e)},document.getElementById(addMins.id).onkeypress=function(e){LimitImputLength(e)},document.getElementById(btnExport.id).onclick=function(e){ExportAsCSV(e),e.stopPropagation()}};